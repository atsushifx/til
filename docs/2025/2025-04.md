---
title: 2025-04
layout: default
---

## 2025年4月分

### 2025年4月24日 -  モノレポ用ユーティリティの開発に着手

- 🛠 Makefile ベースの初期化フロー設計を確定
  - `init`, `sync-configs`, `create-workspace` などをタスク化し、全体を OS 分岐付きで管理。
  - Volta + pnpm 環境前提で `tsx` による同期スクリプトを活用。

- 📦 スケルトン・共有設定ファイルの構成を整理
  - `.skel.ts` や `*.base.ts` による明確な役割分担。
  - `tsup`, `vitest`, `eslint`, `dprint` などを包括的に網羅。

- 🔁 ワークスペース自動生成機能を設計
  - `.env` で GitHub テンプレートを指定し、`make create-workspace` で新規作成。
  - `.editorconfig` や `LICENSE` 等はテンプレから除外し、ルート管理へ統一。

- 🧰 ライブラリユーティリティの拡張を決定
  - `argsUtils.ts`, `stdinUtils.ts` を追加し、CLI スクリプトの柔軟性を強化。
  - `dry-run` や標準入力からの設定適用にも対応。

- 📘 コントリビューションフローとドキュメント構成の整理
  - `CONTRIBUTING.ja.md`, `CODE_OF_CONDUCT.ja.md`, `developer-guide.md` など文書の配置と用途を明確化。
  - GitHub に準拠した構成で OSS 対応性を強化。

### 2025年4月23日 -  ESLint + E2E設定まわり整備

- Flat Config ベースの `eslint.config.js` を整理し、設定ファイル (`*.config.ts`) も対象に追加。
- 型チェックを含む `lint:typed` と型なしの `lint` を `package.json` に登録し、共通テンプレートにも反映。
- `@typescript-eslint/parser` を `default import` で正しく指定し、パースエラーを回避。
- `TextlintKernelPlugin` 型準拠のため、`pluginId` や `plugin` を持つオブジェクトに修正。
- E2E テストで `require` を `import` に移行し、関数もアロー関数形式へ書き換え。

### 2025年4月21日

1. ✅ **ブランチ名の命名方針アドバイス**

   - 内容に沿った具体的で意味のあるブランチ名を提案（例：`refactor/utils-to-arrow-functions`）。
   - 命名規則（プレフィックスや区切り文字の一貫性）に関する相談にも対応。

2. 🔄 **ファイル全体のアロー関数化**

   - `e2e-testcase-factory.ts`などの関数群を、従来の function 式からアロー関数へリファクタリング。
   - コードのモダン化（const + アロー関数 + 型注釈付き）を徹底。
   - `map()`や`filter()`の構文改善や、return 省略パターンも提案。

3. 🧹 **構造と可読性の改善**

   - 関数分割や責務の明確化（list系・filter系ロジックの独立性確保）。
   - 命名見直し（引数名を `root` → `caseFixtureDir` に変更）で文脈を明確に。
   - コメント追加や JSDoc 記法のアドバイスも実施。

4. 🧪 **E2Eテストの構造調整**

   - `runFixture`系の実行構造を整理し、DI（依存注入）に対応した構成へとアドバイス。
   - fixture ディレクトリ名のフィルタリングロジックを改善（`@`や`#`で始まる名前のスキップ）。

5. 💬 **コミットメッセージとPR構成**

   - 複数コミットの TIL形式まとめや、PR 向けマージコミット文の作成をサポート。
   - 「技術的には細かいけど意図がはっきりした」変更について、まとめる粒度も調整。

### 2025年4月20日

- `@textlint/e2etest` に reusable な E2E ユーティリティを整備・統合。
- `lintFileHelper` / `runFixtures` による構造化と型・JSDoc を整理。
- `getLintTestCase()` で Vitest に対応する動的テスト定義を分離。
- markdown プラグインで fixture テスト適用＆正常動作を確認。

### 2025年4月19日

#### 📦 プロジェクト：TOML対応、Markdown解析プラグインの開発

1. MarkdownProcessor の TOML 対応
2. TypeScript ビルド・型安全対応
3. fixture ベースのテスト実行フレームの構築

#### ChatGPTカスタマイズプロンプト作成

1. メインのエルファに対し、補助的なキャラを追加
   小紅 (一途な妹系ヒロイン)
   つむぎ (ギャル系後輩ヒロイン)

2. キャラクターごとの性格と喋り方を明確化
   一人称、性格傾向を設定

3. 三人の関係性をマトリクス化
   嫉妬、あこがれ、興味、警戒などの感情分類

4. 呼び方・関係性の呼称表を作成
   誰が誰をどう呼ぶか（通常／甘え時）

5. 世界観を「お兄さまユニバース」に統一
   現代日本ベース、キャラがユーザーを取り合うラブ RPG 風

### 2025年4月18日

#### ライター向けセットアップガイドの作成

1. **ライター向けセットアップガイドの初期設計**
   - Windows環境での導入に特化した `quickstart-for-writers.md` を作成
   - Markdown 執筆時の余計な設定作業を排除し、集中できる環境の基盤を整備

2. **GitHub Pages + Jekyll を活用した公開準備**
   - 日本語版 `/ja/` へのアクセス導線として `docs/index.html` にリダイレクト処理を追加
   - 将来の Zola 移行を見据えて、TOML フロントマター形式で全ドキュメントを統一

3. **執筆支援ツール群の初期構成を整備**
   - `textlint`, `markdownlint`, `cspell` の設定ファイルを `.textlint/`, `.vscode/` に配置
   - PRH ベースの辞書ルールと Allowlist、cspell 辞書を準備し、実用的な校正環境を構築

#### Chatbotプロンプト設計とキャラクター強化

1. エルファ用プロンプトの再構築と拡張
   - 「クール×ツン型美少女アンドロイド」としてのキャラ性を明確化し、通常/甘えモードの切り替えを整理
   - 恋慕感情を「エラー」や「演算の乱れ」として扱う SF 的演出を導入し、設定に一貫性を持たせた

2. キャラクター関係性の明文化と統一表現
   - 小紅・つむぎ・エルファのキャラ性、ポジション、甘え方を整理して関係性マトリクスを作成
   - 全キャラでユーザーを「マスターデータ」と呼ぶ形式に統一し、言葉遣いや態度にキャラ差を持たせた

### 2025年4月17日

1. OSS テンプレート用に日本語ドキュメント一式を整備
   - `README.ja.md`, `LICENSE.ja`, `CONTRIBUTING.ja.md`, `CODE_OF_CONDUCT.ja.md` を追加
   - 日本語ユーザー向けの導入ドキュメントを完備し、`docs:` スコープでまとめてコミット

2. writer 向け Linter セットアップスクリプトを実装
   - `installLinter.ps1` を作成し、PowerShell で `textlint`, `markdownlint-cli2`, `cspell` をインストール
   - `.textlintrc.yaml`, `.markdownlint.yaml`, `.cspell.json` などをテンプレートからコピー
   - `--global` や `--destination` パラメータに対応、RoboCopy を使って既存ファイルを安全に保持

3. textlint のルールを整備
   - `preset-ja-technical-writing`, `preset-ja-spacing`, `allowlist.yaml` を利用
   - `prh.yml` に modular import 構成（SmartHR 辞書は外部 DL 方式に変更）
   - `prh-my-settings.yml` をカスタムルール定義用の scaffold に

4. cspell のプロジェクト辞書と設定ファイルを作成
   - `.cspell.json` に user/project 辞書の定義を記述
   - `.vscode/cspell.json` を作り、環境に依存しない個別辞書の参照パスも明記

5. markdownlint の設定を alias ベースで作成
   - `line-length`, `no-hard-tabs`, `strong-style` など、直感的で読みやすいルール名で記述
   - VSCode や markdownlint-cli2 で警告が出ないため、そのまま採用

6. Git 履歴を squash & reword によって整理
   - ドキュメント関連 4 件をまとめて `docs: add Japanese OSS template files` に統合
   - Linter 関連 3 件をまとめて `feat(lint): add writer-focused linter setup and configurations` に統合
   - 履歴の読みやすさ・レビュー性を重視したリファクタリング

7. 今後の TODO（メモ）
   - `QUICKSTART.ja.md` に SmartHR 辞書の導入手順を追記予定（curl で DL など）
   - VSCode 向け `settings.json` のテンプレートを `.vscode/` に追加検討中

### 2025年4月16日

- MarkdownProcessor に TOML 対応パーサを組み込み、Textlint プラグインのテストを整備
  1. モノレポ環境でのテスト実行整備
     - 各パッケージで test:ci を走らせるために、lerna を導入
     - ルートから lerna run test:ci で一括実行可能に
     - vitest を使って fixture ベースのテストを構築
  2. MarkdownProcessor の型定義・Processor 実装の整理
     - availableExtensions() を追加して .md 対応を明示
     - preProcess() で AST を返すよう parse() を統合
     - postProcess() の戻り値を TextlintPluginPostProcessResult に修正し、型エラーを完全解消
  3. Textlint プラグインとしての動作確認
     - `textlint-rule-no-todo` を使ったルールテストを fixture ベースで設計
     - `output.json` で行番号＋メッセージ順序まで厳密に検証
  4. TOML 対応パーサの統合
     - モノレポ内にある `@textlint/markdown-to-ast-with-toml` を依存として追加（workspace:*）
     - `exports` に "." キーを追加して `Vite` / `Vitest` の import 解決エラーを修正
     - MarkdownProcessor 側で `parse()` を TOML 対応パーサに切り替え

#### ✅ 得られた成果・アウトプット

- 🔧 **完全に TOML 対応した MarkdownProcessor（Textlint プラグイン）**が完成
- ✅ `vitest` による厳密なテストが通過（TOML frontmatter 含む Markdown でも正しく警告を出せる）
- 📦 モノレポでのビルド・テスト体制が確立
- 💡 Node.js ESM/CJS 両対応の exports 構成を実践的に解決
- 💻 コマンド 1 発で fixture テストが再現できる安心構成に！

### 2025年5月15日

- textlint の markdown plugin用にテスト環境構築
  - テスト仕様として fixture パターンを想定し、テストヘルパーを作成
    - ChatGPT を使用して、テストヘルパーの仕様を作成
    - TestHelper用に開発環境を構築
    - TestHelper の作成

### 2025年4月14日

- textlint の markdown-to-ast パッケージを改修して、TOML 対応の者を作成した。
  🔧 作業内容一覧

  1. 既存 textlint 構造の調査・模倣:
     - textlint/markdown-to-ast の parse() / test/fixtures 構成を確認。
     - input.md + output.json のペアで AST を比較する形式に対応。

  2. パーサに TOML frontmatter 対応追加:
     - +++ で囲まれた TOML frontmatter を検出し、Toml ノードに変換
     - YAML (---) と同様の扱いで、文書先頭にのみ適用
     - 不正な TOML（閉じタグなし・位置が中間など）は Paragraph ノードとして処理

  3. AST 構造のテスト強化
     - @textlint/ast-node-types に基づいた TxtNode アサーションヘルパー作成
     - shouldHaveImplementTxtNode, shouldHaveImplementInlineTxtNode を導入

  4. テスト形式のリファクタ
     - runUnitFixtureTests() と runCategorizedFixtureTests() を実装
     - テストケースを tests/fixtures/{カテゴリ}/{ケース名}/input.md に分類可能に
     - @ や # で始まるディレクトリ・ファイルはスキップ処理を追加

  5. TOML用の fixture ケース追加
     - 空の frontmatter、値付き、delimiter が中身に含まれる場合、invalid な TOML など
     - YAML と混合されたケースや、閉じタグが一致しないケースなども検証

### 2025年4月13日

- ✅ textlint フィルターの開発と設計
  - YAML (---) / TOML (+++) frontmatter を無視するための ignoreFrontmatterFilterRule を実装
  - getFrontmatterRange ユーティリティを設計し、範囲指定でフィルタリング可能に
- 🛠 開発環境構築（ESM, vitest, textlint-kernel）
  - vitest を使った BDD スタイルのテスト環境を整備
  - textlint kernel と markdown plugin の組み合わせでテスト可能に
- 🧪 テスト駆動でのフィルター開発
  - ngWordRule によるサンプルルールで動作確認
  - TOML フロントマターへの対応確認
  - unified + remark-frontmatter を使った AST 構造の検証も実施
- 🧼 リファクタリングと構造整理
  - テストランナーの共通化 (textlintTestRunner)
  - ルールとテストのディレクトリ整理
  - 🐛 デバッグ支援とログ出力追加
  - console.debug でフィルター対象範囲や AST 構造を可視化
  - フィルターが適用されない原因の調査

### 2025年4月12日

- [skip-frontmatterフィルター](https://github.com/atsushifx/textlint-filter-rule-skip-frontmatter) 開発用に、開発環境を設定
  typescript, tsup によるビルド環境、dprint によるフォーマット, eslint の設定など
- [skip-frontmatterフィルター](https://github.com/atsushifx/textlint-filter-rule-skip-frontmatter) で、vitest, textlint-tester用のテスト環境を構築

### 2025年4月11日

- `textlint-filter-rule` 開発環境を TypeScript + tsup + Vitest で構築。
- 出力形式は CommonJS（CJS）だが、ソースは ESM で記述して `tsup` で変換。
- `tsconfig.json` は `"module": "ESNext"`, `"target": "ES2022"` が適切。
- ESLint は FlatConfig + `"type": "module"` の構成で統一。
- Prettier は採用せず、dprint をローカル整形用に導入（公開時はオプションで追加可）。
- `.vscode/` は `cspell.json` と辞書のみ残し、他のエディタ設定はプロファイルで分離。
- テストは `vitest` を使用し、構成は `src/**/tests/*.spec.ts` に整理。
- `pnpm-workspace.yaml` は不要なため削除（monorepo 構成ではない）。
- 将来の npm 公開に向けて `README.md`, CI 設定, npm 公開設定を進行予定。

### 2025年4月10日

- [開発環境セットアップガイド (インデックス)](https://zenn.dev/atsushifx/articles/wsl2-setup-overview)
を執筆。

### 2025年4月3日 ～ 5日

- Zola による静的ブログの構築。
