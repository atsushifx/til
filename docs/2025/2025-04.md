---
title: 2025-04
layout: default
---

## 2025年4月分

### 2025年5月16日

- MarkdownProcessor に TOML 対応パーサを組み込み、Textlint プラグインのテストを整備
  1. モノレポ環境でのテスト実行整備
     - 各パッケージで test:ci を走らせるために、lerna を導入
     - ルートから lerna run test:ci で一括実行可能に
     - vitest を使って fixture ベースのテストを構築
  2. MarkdownProcessor の型定義・Processor 実装の整理
     - availableExtensions() を追加して .md 対応を明示
     - preProcess() で AST を返すよう parse() を統合
     - postProcess() の戻り値を TextlintPluginPostProcessResult に修正し、型エラーを完全解消
  3. Textlint プラグインとしての動作確認
     - `textlint-rule-no-todo` を使ったルールテストを fixture ベースで設計
     - `output.json` で行番号＋メッセージ順序まで厳密に検証
  4. TOML 対応パーサの統合
     - モノレポ内にある `@textlint/markdown-to-ast-with-toml` を依存として追加（workspace:*）
     - `exports` に "." キーを追加して `Vite` / `Vitest` の import 解決エラーを修正
     - MarkdownProcessor 側で `parse()` を TOML 対応パーサに切り替え

#### ✅ 得られた成果・アウトプット

- 🔧 **完全に TOML 対応した MarkdownProcessor（Textlint プラグイン）**が完成
- ✅ `vitest` による厳密なテストが通過（TOML frontmatter 含む Markdown でも正しく警告を出せる）
- 📦 モノレポでのビルド・テスト体制が確立
- 💡 Node.js ESM/CJS 両対応の exports 構成を実践的に解決
- 💻 コマンド 1 発で fixture テストが再現できる安心構成に！

### 2025年5月15日

- textlint の markdown plugin用にテスト環境構築
  - テスト仕様として fixture パターンを想定し、テストヘルパーを作成
    - ChatGPT を使用して、テストヘルパーの仕様を作成
    - TestHelper用に開発環境を構築
    - TestHelper の作成

### 2025年4月14日

- textlint の markdown-to-ast パッケージを改修して、TOML 対応の者を作成した。
  🔧 作業内容一覧

  1. 既存 textlint 構造の調査・模倣:
     - textlint/markdown-to-ast の parse() / test/fixtures 構成を確認。
     - input.md + output.json のペアで AST を比較する形式に対応。

  2. パーサに TOML frontmatter 対応追加:
     - +++ で囲まれた TOML frontmatter を検出し、Toml ノードに変換
     - YAML (---) と同様の扱いで、文書先頭にのみ適用
     - 不正な TOML（閉じタグなし・位置が中間など）は Paragraph ノードとして処理

  3. AST 構造のテスト強化
     - @textlint/ast-node-types に基づいた TxtNode アサーションヘルパー作成
     - shouldHaveImplementTxtNode, shouldHaveImplementInlineTxtNode を導入

  4. テスト形式のリファクタ
     - runUnitFixtureTests() と runCategorizedFixtureTests() を実装
     - テストケースを tests/fixtures/{カテゴリ}/{ケース名}/input.md に分類可能に
     - @ や # で始まるディレクトリ・ファイルはスキップ処理を追加

  5. TOML用の fixture ケース追加
     - 空の frontmatter、値付き、delimiter が中身に含まれる場合、invalid な TOML など
     - YAML と混合されたケースや、閉じタグが一致しないケースなども検証

### 2025年4月13日

- ✅ textlint フィルターの開発と設計
  - YAML (---) / TOML (+++) frontmatter を無視するための ignoreFrontmatterFilterRule を実装
  - getFrontmatterRange ユーティリティを設計し、範囲指定でフィルタリング可能に
- 🛠 開発環境構築（ESM, vitest, textlint-kernel）
  - vitest を使った BDD スタイルのテスト環境を整備
  - textlint kernel と markdown plugin の組み合わせでテスト可能に
- 🧪 テスト駆動でのフィルター開発
  - ngWordRule によるサンプルルールで動作確認
  - TOML フロントマターへの対応確認
  - unified + remark-frontmatter を使った AST 構造の検証も実施
- 🧼 リファクタリングと構造整理
  - テストランナーの共通化 (textlintTestRunner)
  - ルールとテストのディレクトリ整理
  - 🐛 デバッグ支援とログ出力追加
  - console.debug でフィルター対象範囲や AST 構造を可視化
  - フィルターが適用されない原因の調査

### 2025年4月12日

- [skip-frontmatterフィルター](https://github.com/atsushifx/textlint-filter-rule-skip-frontmatter) 開発用に、開発環境を設定
  typescript, tsup によるビルド環境、dprint によるフォーマット, eslint の設定など
- [skip-frontmatterフィルター](https://github.com/atsushifx/textlint-filter-rule-skip-frontmatter) で、vitest, textlint-tester用のテスト環境を構築

### 2025年4月11日

- `textlint-filter-rule` 開発環境を TypeScript + tsup + Vitest で構築。
- 出力形式は CommonJS（CJS）だが、ソースは ESM で記述して `tsup` で変換。
- `tsconfig.json` は `"module": "ESNext"`, `"target": "ES2022"` が適切。
- ESLint は FlatConfig + `"type": "module"` の構成で統一。
- Prettier は採用せず、dprint をローカル整形用に導入（公開時はオプションで追加可）。
- `.vscode/` は `cspell.json` と辞書のみ残し、他のエディタ設定はプロファイルで分離。
- テストは `vitest` を使用し、構成は `src/**/tests/*.spec.ts` に整理。
- `pnpm-workspace.yaml` は不要なため削除（monorepo 構成ではない）。
- 将来の npm 公開に向けて `README.md`, CI 設定, npm 公開設定を進行予定。

### 2025年4月10日

- [開発環境セットアップガイド (インデックス)](https://zenn.dev/atsushifx/articles/wsl2-setup-overview)
を執筆。

### 2025年4月3日 ～ 5日

- Zola による静的ブログの構築。
