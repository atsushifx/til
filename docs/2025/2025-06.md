---
title: 2025-06
layout: default
---

## 2025年6月分

### 2025年6月4日-- ESTA開発: オンボーディング用ドキュメント作成

#### 🛡️ 概要（ライセンスと構成）

本日は、ESTA プロジェクトのオンボーディングドキュメントとして、第 7〜10 章（途中）を執筆。
パッケージ構成、スクリプト設計、コード／ドキュメント品質のルールを明文化。

プロジェクトは **MITライセンス** であり、`README`にはその旨と著作権表記の明示を記載した。
派生物においてもライセンスおよびコピーライトは保持されるよう記述した。

#### 各セクションの執筆概要

- 第7章: Monorepo 設計と pnpm 構成
  - `pnpm` による monorepo 管理方式とルートの役割、workspace 配下の構成方針を明記
  - パッケージ単位の依存解決、並列実行 (`-r`) への対応例を紹介
- 第8章: スクリプト運用とルール化
  - `package.json` のスクリプトを役割別に定義し、ドキュメントとして整理
  - 各パッケージで共通的に利用するためのスクリプト統合と命名規約も適用
- 第9章: コード品質チェックツール
  - 使用するツール群 (`eslint`, `prettier`, `stylelint`, `tsc`) の一覧と役割を記載
  - VSCode と統合した開発支援環境構築に関する補足記述も付属
- 第10章（前半）: ドキュメント品質チェック
  - `textlint`, `markdownlint`, `CSpell` によるドキュメント校正フローを明記
  - `allowlist`, `textlint-disable`, `prh` など例外処理の記法も記述
  - `pnpm run` による実行例・オプションも併記済み

#### 🌸 気づき

- ドキュメントもコードと同等の Lint 対象として整備すべきという意識が強まった
- ツール群の構成とスクリプト命名で迷わなくなる恩恵が大きい

#### 🔁 レトロスペクティブ（3人視点）

【エルファ】
> 「ライセンス条項の明記完了。READMEと/LICENSEの相互参照による整合性は確認済み。……マスターの作業は、法的にも隙がありません。」

【小紅】
> 「こべに、校正ツールって地味かなって思ってたけど……エラーの無視とか、許可リストとか、ちゃんと書き方あってすごかったですっ！🥺センパイに教えてもらって、賢くなった気がするぅ〜💖」

【つむぎ】
> 「ふふ……“textlint-disable”とかって、使い方間違えるとダサいのよね〜。でもセンパイの書き方見たら、あーしも真似したくなっちゃった……ちゃんと理由つけて、賢いって感じ〜♡」

### 2025年6月3日-- ESTA開発: オンボーディング用ドキュメント作成

#### パッケージマネージャー導入フロードキュメント作成

- **Volta / pnpm / scoop / winget** のセットアップ手順を整理
- Volta による Node.js / pnpm のバージョン管理と環境変数の設定を明記
- `pnpm` グローバルインストール時の `global-bin-dir`の**Path追記**を明示

#### 気づき

- `pnpm config get global-bin-dir`の出力を`Path`に反映する必要あり
- `volta` は PowerShell 再起動しないと反映されないことがあるため、再起動指示は必須。
- 一見「当たり前」な手順こそ、新規参加者のつまずきポイントになるため、丁寧なドキュメントが重要。

### 2025年6月2日 -- ESTA開発: errorによる実行制御の要件定義

#### 🔧 今日のテーマ

プロセス終了処理 (`process.exit`) の一元化とログ出力・exitCode 制御の分離。
CLI / Node.js ツールにおける「異常終了」と「制御可能エラー」の切り分け設計を行なった。

#### ✅ 導入する構成と機能

### 1. `fatalExit(code, message)`

- 標準エラー出力にログを出力
- 即時 `process.exit(code)`
- 制御は戻らず強制終了

### 2. `errorExit(code, message)`

- カスタム例外 `ExitError` を throw
- 上位で `try...catch` により補足・制御可能

#### 📦 `ExitError` の実装

- `Error` を拡張
- `code: ExitCode` を保持
- `instanceof` 判定・stacktrace 対応済み

#### 🔢 `ExitCode` enum の管理

```ts
export enum ExitCode {
  SUCCESS = 0,
  ERR_UNKNOWN = 1,
  ERR_CONFIG_NOT_FOUND = 2,
  ERR_COMMAND_EXECUTION = 3,
  ERR_INVALID_ARGS = 4, // ← 追加
}
```

#### 📊 errorLevel グローバル構想

- `Log.error()` 時に `errorLevel` を記録
- `errorLevel > 0` で最終的に `fatalExit(errorLevel)`
- ログ出力にはログレベル不要、処理判断目的に限定

#### 📁 構成方針

| 要素 | パス案 |
|------|--------|
| fatalExit / errorExit | `@ag-system/exit-handlers` |
| ExitCode 定義 | `@shared/types/exitCode.ts` |
| ExitError クラス | `src/system/ExitError.ts` or `src/errors/ExitError.ts` |

## 📝 所感・補足

- `throw` によるエラー制御は柔軟かつ再利用性が高い
- fatal と error の二層構造で CLI の信頼性向上
- enum によるエラーコードの定義はロギング・CI との連携に有効

---
